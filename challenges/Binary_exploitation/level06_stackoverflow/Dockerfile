FROM ubuntu:20.04

# Avoid interactive prompts during build
ENV DEBIAN_FRONTEND=noninteractive

# Install dependencies
RUN apt update && apt install -y \
    gcc \
    python3 \
    python3-pip \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# Set working directory
WORKDIR /home/ctfuser

# Copy challenge files
COPY vuln.c flag.txt index.html ./

# Compile vulnerable binary
RUN gcc -no-pie -fno-stack-protector vuln.c -o vuln

# Expose web server port
EXPOSE 8000

# Start Python web server
CMD ["python3", "-m", "http.server", "8001"]
